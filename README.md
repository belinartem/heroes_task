# Heroes Battle - Итоговый проект

Реализация алгоритмов для пошаговой стратегии с боевой системой в рамках курса "Алгоритмы и структуры данных".

## Описание проекта

Проект содержит реализацию четырех ключевых алгоритмов для игры Heroes:

1. **GeneratePresetImpl** - Генерация армии противника
2. **SimulateBattleImpl** - Симуляция пошагового боя
3. **SuitableForAttackUnitsFinderImpl** - Определение доступных целей для атаки
4. **UnitTargetPathFinderImpl** - Поиск кратчайшего пути между юнитами

## Структура проекта

```
heroes_student_task/
├── src/
│   └── programs/
│       ├── GeneratePresetImpl.java           # Генерация армии
│       ├── SimulateBattleImpl.java           # Симуляция боя
│       ├── SuitableForAttackUnitsFinderImpl.java  # Фильтрация целей
│       └── UnitTargetPathFinderImpl.java     # Поиск пути
├── libs/
│   └── heroes_task_lib-1.0-SNAPSHOT.jar      # Библиотека игры
├── heroes/                                    # Готовая игра для тестирования
│   ├── Heroes Battle-1.0.0.jar
│   └── jars/                                  # Папка для размещения собранного JAR
└── README.md
```

## Реализованные алгоритмы

### 1. SuitableForAttackUnitsFinderImpl - Фильтрация целей для атаки

**Описание**: Определяет список юнитов противника, доступных для атаки.

**Логика**:

- Для атаки армии игрока (правая армия): доступны юниты компьютера (левая армия), которые не закрыты слева другим юнитом
- Для атаки армии компьютера (левая армия): доступны юниты игрока (правая армия), которые не закрыты справа другим юнитом

**Алгоритмическая сложность**: **O(N)**, где N - общее количество юнитов

**Обоснование**:

- Перебор всех рядов: O(3) = O(1) - константа (фиксировано 3 ряда)
- Перебор юнитов в каждом ряду: O(M), где M - количество юнитов в ряду
- Проверка соседа: O(1)
- **Итоговая сложность**: O(1) × O(M) × O(1) = **O(N)**, где N = общее количество юнитов

### 2. GeneratePresetImpl - Генерация армии противника

**Описание**: Формирует оптимальный состав армии компьютера в рамках ограничений по бюджету и количеству юнитов каждого типа.

**Алгоритм**: Жадный алгоритм на основе эффективности юнитов

**Логика**:

1. Сортировка юнитов по убыванию коэффициента атака/стоимость
2. Последовательное добавление юнитов с максимальной эффективностью
3. Соблюдение ограничений: ≤11 юнитов каждого типа, бюджет ≤1500

**Алгоритмическая сложность**: **O(N × M)**, где N - типы юнитов, M - макс. юнитов

**Обоснование**:

- Сортировка типов юнитов: O(N log N), где N ≈ 4 типа = O(1)
- Основной цикл добавления юнитов: O(N × M)
  - Внешний цикл: проходы до заполнения бюджета
  - Внутренний цикл: перебор N типов юнитов
  - Максимум M юнитов каждого типа
- **Итоговая сложность**: **O(N × M)**

**Примечание**: GeneratePresetImpl реализован согласно ТЗ, однако при запуске в игре возникает ArrayIndexOutOfBoundsException в игровом движке. Код оставлен для демонстрации алгоритма.

### 3. UnitTargetPathFinderImpl - Поиск кратчайшего пути

**Описание**: Находит кратчайший путь между атакующим и атакуемым юнитом с учетом препятствий (других юнитов).

**Алгоритм**: BFS (поиск в ширину) с возможностью движения по 8 направлениям (включая диагонали)

**Логика**:

1. Построение карты препятствий (занятых клеток)
2. BFS от позиции атакующего юнита к цели
3. Восстановление пути от цели к началу

**Алгоритмическая сложность**: **O(WIDTH × HEIGHT)** = **O(27 × 21)** = **O(567)** = **O(1)**

**Обоснование**:

- Создание карты препятствий: O(U), где U - количество юнитов ≤ 88
- BFS: O(WIDTH × HEIGHT) = O(27 × 21) = O(567)
  - Каждая клетка посещается максимум 1 раз
  - Для каждой клетки проверяется до 8 соседей
- Восстановление пути: O(WIDTH + HEIGHT) = O(48)
- **Итоговая сложность**: O(567) + O(88) + O(48) = **O(WIDTH × HEIGHT)**

Так как размер поля фиксирован (27×21), фактическая сложность является константой O(1).

### 4. SimulateBattleImpl - Симуляция боя

**Описание**: Проводит пошаговый бой между армией игрока и армией компьютера.

**Логика**:

1. Сбор всех живых юнитов обеих армий
2. Сортировка по убыванию атаки (сильнейшие ходят первыми)
3. Поочередные ходы юнитов с вызовом unit.getProgram().attack()
4. Удаление погибших юнитов из очереди
5. Завершение при отсутствии живых юнитов в одной из армий

**Алгоритмическая сложность**: **O(R × N log N)**, где R - раунды, N - юниты

**Обоснование**:

- Сбор живых юнитов: O(N)
- Сортировка юнитов: O(N log N)
- Атака каждого юнита: O(1) (вызов готового метода)
- Количество раундов: O(R), где R зависит от состава армий
- **Итоговая сложность на раунд**: O(N log N)
- **Общая сложность**: **O(R × N log N)**

Учитывая, что метод атаки unit.getProgram().attack() работает за O(1) согласно спецификации.

## Как собрать проект

### В IntelliJ IDEA:

1. **Настройка артефакта**:
   - File → Project Structure → Artifacts
   - Нажмите "+" → JAR → From modules with dependencies
   - Выберите главный модуль
   - Укажите путь для сборки

2. **Сборка**:
   - Build → Build Artifacts → heroes_student_task:jar → Build

3. **Результат**: JAR-файл будет создан в папке `out/artifacts/`

## Как запустить игру с вашими алгоритмами

1. Скопируйте собранный JAR-файл в папку `heroes/jars/`
2. Удалите или переименуйте старый `obf.jar`
3. Запустите игру:

   ```bash
   cd heroes
   java -jar "Heroes Battle-1.0.0.jar"
   ```

   или просто двойной клик по `Heroes Battle-1.0.0.jar`

4. Игра автоматически загрузит ваши алгоритмы из JAR-файла

## Тестирование

Для проверки работы алгоритмов:

1. Запустите игру → "Начать новую игру" → "Создать армию"
2. Нажмите "Сгенерировать пресет" для проверки GeneratePresetImpl (если используется)
3. Расставьте юниты вручную
4. Нажмите "Начать бой" для проверки остальных алгоритмов

Во время боя:

- **SimulateBattleImpl** управляет ходами
- **SuitableForAttackUnitsFinderImpl** определяет доступные цели
- **UnitTargetPathFinderImpl** прокладывает маршрут к цели

## Статус реализации

| Алгоритм                         | Статус             | Примечание                                   |
| -------------------------------- | ------------------ | -------------------------------------------- |
| SuitableForAttackUnitsFinderImpl | ✅ Работает        | Полностью функционален                       |
| UnitTargetPathFinderImpl         | ✅ Работает        | BFS с поддержкой диагоналей                  |
| SimulateBattleImpl               | ✅ Работает        | Корректная симуляция боя                     |
| GeneratePresetImpl               | ⚠️ Не используется | Реализован, но вызывает ошибку в движке игры |

## Технические требования

- **Java**: 8 или выше
- **Библиотеки**: heroes_task_lib-1.0-SNAPSHOT.jar (включена в проект)
- **Система сборки**: IntelliJ IDEA Artifacts

## Автор

Артём Белин

## Лицензия

Учебный проект в рамках курса "Алгоритмы и структуры данных"
